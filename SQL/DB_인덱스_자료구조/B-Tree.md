---
상태: 진행중
시작일: 2024-06-04
마감일: 2024-06-04
---
## B-Tree 구조
> 매우 중요한 자료 구조 중 하나, 데이터베이스와 파일 시스템에서 자주 사용된다.
> 균형 이진 탐색 트리(Binary Search Tree)의 일반화된 형태로, 노드가 다수의 자식을 가질 수 있어 데이터의 삽입, 삭제, 검색이 효율적으로 이루어집니다.

## 이진 탐색 트리(BST)
**노드의 갯수**가 **최대 2개** 까지 가질 수 있다.
모든 노드의 **왼쪽 서브 트리는 해당 노드의 값보다 작은 값**들만 가지고 **오른쪽 서브 트리는 해당 노드으 값보다 큰 값**들만 가진다.
![](https://i.imgur.com/etzvxSL.png)

## B-Tree의 파라미터
- **M : 각 노드의 최대 자녀 노드 수**(가장 중요한 파라미터)
	- 최대 M개의 자녀를 가질 수 있는 B tree를 M차 B tree라 부른다.

- M-1 : 각 노드의 최대 Key 수
- ⌈M/2⌉ : 각 노드의 최소 자녀 노드수
	- ⌈ ⌉ -> 올림 기호
	- 만약 M이 3이라면 3/2 = 1.5인데 올림을 해야해서 최소 자녀 노드수는 2가 된다.
	- root node, leaf node는 제외

- ⌈M/2⌉ -1 : 각 노드의 최소 key 수
	- root node 제외


## B-Tree 특징
internal 노드의 key수가 x 개라면 자녀 노드의 수는 언제나 x+1 개다.
![](https://i.imgur.com/YtOmGce.png)

위의 그림은 x가 2개인데 자녀 노드가 2개이기 때문에 x+1의 규칙을 벗어납니다. b-tree 에서 이런 구조는 있을 수 없습니다

또한, 아래의 그림처럼 x=1인 상황에서 자녀 노드가 3이면 x+1 규칙에 어긋나기 때문에 이런 구조도 있을 수 없습니다.
![](https://i.imgur.com/Vy6pHLA.png)

Tip)
> 노드가 최소 하나의 key는 가지기 때문에 몇 차 B-Tree 인지와 상관없이 internal 노드는 최소  두 개의 자녀는 가진다.

## B-Tree 데이터 삽입
- 데이터 추가는 항상 leaf 노드에서 발생한다.
- 노드가 넘치면 가운데(median) key를 기준으로 좌우 key들은 분활하고 가운데 key는 올라간다.

예를들어, 3차 B-Tree가 있다고 할때 데이터를 삽입하면?
### 1 추가
**M : 각 노드의 최대 자녀 노드수**
**M-1: 각 노드의 최대 key 수**

3차 B-Tree를 사용하기 때문에 각 노드의 최대 key 수가 3-1 = 2로 2칸을 가지게 된다. 
![](https://i.imgur.com/PBeVCGS.png)

### 15 추가
**추가는 항상 leaf 노드에서 발생한다.**

가장 처음에는 root 노드이기도 하지만 leaf 노드이기도 하기 때문에 처음 1을 추가했던 노드에 추가된다.
![](https://i.imgur.com/cxm7394.png)

### 2 추가
노드는 항상 오름차순 정렬이된 상태로 저장을 하게됩니다.

최대 key의 수는 2인데 데이터가 3개가 되었기 때문에 노드에 저장할 수 없습니다. 그래서 분할이 발생합니다. 가운데 있던 2는 위로 올라가고 좌우에 있던 1과 15가 양쪽으로 분할이 되어 2의 자식 노드가 됩니다.
![](https://i.imgur.com/DcwR0k2.png)

### 5 추가
5를 추가하면 2보다 크기 때문에 15가 있는 노드에 가게 될 것입니다. 노드는 항상 오름차순 정렬이 된 상태이기 때문에 15의 앞에 위치하게 될 것입니다.
![](https://i.imgur.com/kVlj8r8.png)

### 30 추가
