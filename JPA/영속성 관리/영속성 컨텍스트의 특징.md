---
상태: 완료
시작일: 2024-05-30
---
JPA를 사용한다는 것은 영속성 컨텍스트를 사용한다는 것이고 그럼 영속성 컨텍스트의 이점을 누릴 수 있다는 말과 같다고 생각합니다.
### 영속성 컨텍스트 특징
- **1차 캐시**
- **동일성 보장**
- **트랜잭션을 지원하는 쓰기 지연**
- **변경 감지**
- **지연 로딩**
### 1. 1차캐시
1차 캐시에 들어있는 entity의 경우 DB를 거치지 않고 조회가 가능합니다.
![](https://i.imgur.com/9LLgueV.png)

하지만 1차 캐시에 없는 member2를 조회한다면?
`em.find(Member.class, "member2")`
![](https://i.imgur.com/QDyG6xX.png)
1. 엔티티매니저를 통해서 entity를 조회하고 1차 캐시에 없다면
2. DB를 조회해서 entity를 찾는다. 찾은 entity를 1차 캐시에 저장을 하고
3. 반환합니다.

### 2. 동일성 보장
JPA의 영속성 컨텍스트는 **동일성을 보장**합니다.
Tip)
> 동일성: 주소값이 같은 것을 의미 == 비교
> 동등성: 값이 같은 것을 의미 equals()

`member1 == member2` 참일까? 거짓일까?
```Java
	Member member1 = em.find(Member.class, "member1");
	Member member2 = em.find(Member.class, "member1");
	System.out.println(member1 == member2);
	
```
결과는 참입니다.  entity를 조회할때 `member1`이라는 동일한 `Id`로 조회했기 때문에 1차 캐시에서 당연히 같은 entity가 조회될 것입니다. 

### 3. 트랜잭션을 지원하는 쓰기 지연
